---
output: github_document
---

# Purpose

Purpose of this work folder.

Ideally store a minimum working example data set in data folder.

Add binary files in bin, and closed R functions in code. Human Readable settings files (e.g. csv) should be placed in settings/


```{r}

rm(list = ls()) # Clean your environment:
gc() # garbage collection - It can be useful to call gc after a large object has been removed, as this may prompt R to return memory to the operating system.
library(tidyverse)
library(RColorBrewer)
library(xtable)
library(lubridate)
library(huxtable)
library(knitr)
list.files('code/', full.names = T, recursive = T) %>% .[grepl('.R', .)] %>% as.list() %>% walk(~source(.))
covid_data <- read.csv("/Users/gracegrant/Documents/Postgrad/Masters/Data Science/Take home exam/Question 1/data/Covid/owid-covid-data.csv")
deaths_by_cause <- read.csv("/Users/gracegrant/Documents/Postgrad/Masters/Data Science/Take home exam/Question 1/data/Covid/Deaths_by_cause.csv")
description <- read.csv("/Users/gracegrant/Documents/Postgrad/Masters/Data Science/Take home exam/Question 1/data/Covid/covid_data_description.csv")
combined_data <- bind_rows(covid_data, description)
rm(combined_data)
```
\newpage
# Question 1: COVID
1.1 It might be interesting to look at vaccinations in Africa and the outbreak of the pandemic compared to other regions. For this question I could maybe also look at the deaths by cause database to see how COVID deaths differed to deaths before COVID.
```{r bar deaths}

total_deaths_per_continent <- df_cleaned %>% group_by(location) %>% mutate(total_deaths = total_deaths / 1000000) %>%
  summarise(total_deaths = sum(total_deaths)) 

rm(continent_covid)
rm(df_subset)
rm(bar_deaths)
rm(covid_updated)
rm(df_cleaned)
rm(g)
rm(plot_total_deaths_per_continent)

covid_cleaned <- covid_data %>%
  filter(location %in% c("Africa", "Asia", "North America", "Oceania", "South America", "Europe")) %>% mutate(total_deaths = ifelse(is.na(total_deaths), 0, total_deaths))

covid_cleaned <- covid_cleaned %>% mutate(total_cases = ifelse(is.na(total_cases), 0, total_cases))

bar_deaths <- plot_deaths(covid_cleaned)
bar_deaths
```
This first graph shows the total number of deaths (in millions) for each continent from COVID.

```{r}
library(lubridate)
library(dplyr)
rm(monthly_cases)
rm(covid_data_2020)

suppressWarnings(line_cases <- plot_cases(covid_cleaned))
line_cases
```
This graph shows how each continent experienced a growth in total cases (in millions) in 2020.

1.2 For this question, I'm going to use scatterplots to see correlations. I want to see how the United States, United Kingdom and Australia differed in their total deaths and life expectancy. These countries are all relatively similar
```{r LE table}
countrylist <- c("United States", "United Kingdom", "Australia")
country_covid <- covid_data %>% filter(location %in% countrylist)

mean_life_expectancy <- country_covid %>%
  group_by(location) %>%
  summarize(mean_life_expectancy = mean(life_expectancy, na.rm = TRUE))

table <- mean_life_expectancy %>%
  kable(format = "markdown")
table
```
This table shows that the life expectancy for each of these countries is relatively similar so they should be comparable.
```{r scatter plots}
LE_graph <- plot_deaths_LE(covid_data)
LE_graph

```
This shows that Australia has a much lower total deaths per million figure. I don'think this actaully makes sense.


